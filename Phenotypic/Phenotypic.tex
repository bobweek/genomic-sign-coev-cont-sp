\documentclass{article}

\usepackage{arxiv}

\usepackage[utf8]{inputenc} % allow utf-8 input
\usepackage[T1]{fontenc}    % use 8-bit T1 fonts
\usepackage{lmodern}        % https://github.com/rstudio/rticles/issues/343
\usepackage{hyperref}       % hyperlinks
\usepackage{url}            % simple URL typesetting
\usepackage{booktabs}       % professional-quality tables
\usepackage{amsfonts}       % blackboard math symbols
\usepackage{nicefrac}       % compact symbols for 1/2, etc.
\usepackage{microtype}      % microtypography
\usepackage{lipsum}
\usepackage{graphicx}

\title{The Phenotypic Signature of Host-Parasite Coevolution in Continuous
Space}

\author{
    Bob Week
   \\
    Integrative Biology \\
    Michigan State University \\
  East Lansing, MI 48824 \\
  \texttt{\href{mailto:weekrobe@msu.edu}{\nolinkurl{weekrobe@msu.edu}}} \\
   \And
    Gideon Bradburd
   \\
    Integrative Biology \\
    Michigan State University \\
  East Lansing, MI 48824 \\
  \texttt{\href{mailto:bradburd@msu.edu}{\nolinkurl{bradburd@msu.edu}}} \\
  }


% Pandoc citation processing

\usepackage{amsmath}


\begin{document}
\maketitle

\def\tightlist{}


\begin{abstract}
Here we identify the phenotypic signature of host-parasite coevolution
in continuous space.
\end{abstract}

\keywords{
    blah
   \and
    blee
   \and
    bloo
   \and
    these are optional and can be removed
  }

\hypertarget{introduction}{%
\section{Introduction}\label{introduction}}

Space is hypothesized to play a fundamental role in the coevolutionary
process. In particular, the combined effects of local co-adaptation and
spatial movement are thought to produce complex spatial patterns of
matched and mismatched traits. However, theoretical studies
investigating the spatial signal of coevolution have for the most part
restricted themselves to understanding patterns of spatial correlation
using spatially implicit models. Hence, the fine-grained details that
can be produced in spatially explicit settings have yet to be
understood. Here we close this gap in the context of host-parasite
coevolution using continuous-space models inspired by classical
quantitative genetic theory. In particular, we study the
autocorrelations of mean traits within species and the cross-correlation
of mean traits between species when trait dynamics are driven by (1)
random genetic drift, gene-flow and abiotic stabilizing selection, (2)
drift, gene-flow, abiotic stabilizing selection and unilateral
adaptation of the host species, (3) drift, gene-flow, stabilizing
selection and unilateral adaptation of the parasite species and (4)
drift, gene-flow, stabilizing selection and host-parasite coevolution.
In each case we assuming abiotic stabilizing selection is spatially
homogeneous. By comparing patterns of spatial autocorrelation and
cross-correlation in these four scenarios we are able to elucidate the
signature of coevolution.

\hypertarget{the-model}{%
\section{The Model}\label{the-model}}

\hypertarget{fitness}{%
\subsection{Fitness}\label{fitness}}

The host is denoted \(H\) and the parasite \(P\). Individual trait
values of hosts and parasites are respectively denoted by
\(Z_H,Z_P\in\mathbb R\). Assuming a trait-matching model, where host
fitness is minimized and parasite fitness is maximized when \(Z_H=Z_P\),
we have the following two fitness functions:

\begin{subequations}\label{fit}
  \begin{equation}
    w_H(Z_H,Z_P)\propto \exp\left(-\frac{A_H}{2}(\theta_H-Z_H)^2+\frac{B_H}{2}(Z_P-Z_H)^2\right),
  \end{equation}
  \begin{equation}
    w_P(Z_P,Z_H)\propto \exp\left(-\frac{A_P}{2}(\theta_P-Z_P)^2-\frac{B_P}{2}(Z_H-Z_P)^2\right),
  \end{equation}
\end{subequations}

where \(A_H,A_P>0\) capture the strengths of abiotic stabilizing
selection, \(\theta_H,\theta_P\in\mathbb{R}\) are the abiotic optimal
phenotypes and \(B_H,B_P>0\) capture the strengths of biotic selection
experienced by each species.

\hypertarget{non-spatial-dynamics}{%
\subsection{Non-spatial Dynamics}\label{non-spatial-dynamics}}

Using a standard approach, we use the above fitness functions to derive
the following non-spatial coevolutionary model:

\begin{subequations}\label{non-spatial}
  \begin{equation}
    \frac{d\bar Z_H}{dt}=G_HA_H(\theta_H-\bar Z_H)-G_HB_H(\bar Z_P-\bar Z_H),
  \end{equation}
  \begin{equation}
    \frac{d\bar Z_P}{dt}=G_PA_P(\theta_P-\bar Z_P)+G_PB_P(\bar Z_H-\bar Z_P),
  \end{equation}
\end{subequations}

where \(G_H,G_P>0\) denote the additive genetic variances of each
species. In this linear set of equations, when abiotic stabilizing
selection is absent (\(A_H=A_P=0\)), the parasite mean trait
\(\bar Z_P\) evolves to match the host mean trait \(\bar Z_H\).
Simultaneously \(\bar Z_H\) evolves away from \(\bar Z_P\). In
particular, when \(\bar Z_H>\bar Z_P\), the host mean trait will evolve
upwards. Similarly, when \(\bar Z_H<\bar Z_P\), the host mean trait will
evolve downwards. This and related models have been thoroughly studied
by Sergey Gavrilets and others. For the case when \(A_H=A_P=0\) two
possible outcomes have been demonstrated. First, when \(G_PB_P>G_HB_H\)
so that the parasite evolves faster than the host, the system
asymptotically evolves to the equilibrium \(\bar Z_H=\bar Z_P\). Second,
when \(G_PB_P<G_HB_H\) so that the host evolves faster than the
parasite, there is no stable equilibrium. This implies the host evolves
to escape the interaction. In the case when \(A_H,A_P\neq0\) limit
cycles can emerge.

\hypertarget{space}{%
\subsection{Space}\label{space}}

In this case mean traits become functions of spatial variables (eg.,
\(\bar Z_H(x),\bar Z_P(x)\) where \(x=(x_1,x_2)\in\mathbb R^2\)). As a
first step, we assume all model parameters are spatially homogeneous. If
we assume interactions occur locally (individuals interact only when
they `collide') and abundance densities are spatially homogeneous, then
we can obtain the following continuous space model:

\begin{subequations}\label{deterministic}
  \begin{equation}
    \frac{\partial\bar Z_H}{\partial t}=G_HA_H(\theta_H-\bar Z_H)-G_HB_H(\bar Z_P-\bar Z_H)+\frac{D_H}{2}\Delta\bar Z_H,
  \end{equation}
  \begin{equation}
    \frac{\partial\bar Z_P}{\partial t}=G_PA_P(\theta_P-\bar Z_P)+G_PB_P(\bar Z_H-\bar Z_P)+\frac{D_P}{2}\Delta\bar Z_P,
  \end{equation}
\end{subequations}

where \(D_H,D_P>0\) are dispersal rates for each species and
\(\Delta=\frac{\partial^2}{\partial x_1^2}+\frac{\partial^2}{\partial x_2^2}\)
is the diffusion operator representing spatial movement.

\hypertarget{random-genetic-drift}{%
\subsection{Random Genetic Drift}\label{random-genetic-drift}}

To incorporate the effects of random genetic drift, we should be able to
justify the following SPDE model:

\begin{subequations}\label{spde}
  \begin{equation}
    \frac{\partial\bar Z_H}{\partial t}=G_HA_H(\theta_H-\bar Z_H)-G_HB_H(\bar Z_P-\bar Z_H)+\frac{D_H}{2}\Delta\bar Z_H+\sqrt\frac{G_H}{N_H}\dot W_H,
  \end{equation}
  \begin{equation}
    \frac{\partial\bar Z_P}{\partial t}=G_PA_P(\theta_P-\bar Z_P)+G_PB_P(\bar Z_H-\bar Z_P)+\frac{D_P}{2}\Delta\bar Z_P+\sqrt\frac{G_P}{N_P}\dot W_P,
  \end{equation}
\end{subequations}

where \(N_P,N_H\) are the local abundance densities (here assumed to be
constant in space and time) and \(\dot W_H,\dot W_P\) are space-time
white noise processes. This SPDE model may possess some major benefits
over more traditional continuous-space models of population genetics. In
particular, it is known to have solutions for all spatial dimensions.
The effect of abiotic stabilizing selection may also imply
function-valued solutions.

\hypertarget{methods}{%
\section{Methods}\label{methods}}

To study the continuous-space signature of coevolution, we can start
with an analytical approach. However, if the corresponding calculations
prove to be analytically intractable or time costly, we can employ
simulation-based methods to describe the shape of the autocorrelations
and cross-correlation in relevant regions of parameters space. The
analytical approach would begin by identifying stable attractors of the
deterministic system using classical PDE theory. Following this, we may
possibly apply theory of SPDE to describe stationary distributions
associated with each attractor. This may lend analytical solutions for
the expectation and variance of intraspecific autocorrelations and the
interspecific cross-correlation, which are defined in Appendix
\ref{corr-defs} below.

\hypertarget{a-note-on-biological-diversity-vs-statistical-uncertainty}{%
\subsection{A Note on Biological Diversity vs Statistical
Uncertainty}\label{a-note-on-biological-diversity-vs-statistical-uncertainty}}

An important distinction to make when analyzing spatial patterns of
coevolving species is the difference between statistical uncertainty and
biological variation across space. In particular, we can ignore the
stochastic effects of random genetic drift and focus on patterns
produced by deterministic processes through studying the PDE
(\ref{deterministic}). In this case, we might study quantities such as
the global mean trait values (ie., mean trait values averaged across
space) and the spatial variance of mean trait values. These quantities
are purely functions of existing biological diversity and do not take
into account uncertainties inherit in the process of evolution (eg.,
random genetic drift). Once drift is accounted for, the global mean and
spatial variance of local mean trait values themselves become random
variables.

To understand why spatial expectations and variances become random
variables in the presence of drift, we can think of each possible
instance of the white-noise processes \(\dot W_H,\dot W_P\). In
probability theory these instances are called sample paths and are
typically denoted by the variable \(\omega\). The set of all \(\omega\)
is denoted \(\Omega\) and is referred to as the probability space.
Hence, we would refer to \(\dot W_H(\omega),\dot W_P(\omega)\) as
particular sample paths of the processes \(\dot W_H,\dot W_P\). This
implies that a solution to the stochastic system (\ref{spde}) is really
a set of solutions indexed by \(\omega\in\Omega\). For each \(\omega\)
we can compute spatial averages, variances and covariance of mean
traits. Hence, the probabilistic expectation and variance of these
spatial statistics are found by integrating across \(\Omega\).

This heavily theoretical discussion is important for understanding the
difference between spatial autocorrelation and the covariance function
of a spatial stochastic process. In particular, the spatial
autocorrelation we are interested in (denoted \(\rho_f(r)\) for a
spatial function \(f\)) corresponds to deterministic patterns. Hence,
when accounting for random genetic drift, \(\rho_f\) will be a random
function. To compute the expectation, variance and covariance of this
function, we can use properties of the associated spatial stochastic
process (the expectation and covariance function, denoted \(m(x)\) or
\(m(x_1,x_2)\) and \(C(r)\) respectively, in particular).

Finally, for the sake of completion it is worthwhile to note that
sampling error adds a second layer of stochasticity.

\newpage

\appendix

\hypertarget{spatial-moments}{%
\section{Spatial Moments}\label{spatial-moments}}

Suppose \(f(x)\) is a function of a two-dimensional spatial parameter
\(x=(x_1,x_2)\). For simplicity, let's consider a rectangular subset
\(\Gamma\) of \(\mathbb R^2\) with periodic boundaries (ie., the surface
of a torus). Then we can compute the spatial average of \(f(x)\) via

\begin{equation}
  \bar f = \frac{1}{|\Gamma|}\int_\Gamma f(x)dx,
\end{equation} where \(|\Gamma|\) is the size of the subset \(\Gamma\).
The spatial variance of \(f\) is then

\begin{equation}
  \mathrm{Var}(f) = \frac{1}{|\Gamma|}\int_\Gamma (f(x)-\bar f)^2dx,
\end{equation}

\hypertarget{spatial-autocorrelation-and-cross-correlation}{%
\subsection{\texorpdfstring{Spatial Autocorrelation and
Cross-correlation
\label{corr-defs}}{Spatial Autocorrelation and Cross-correlation }}\label{spatial-autocorrelation-and-cross-correlation}}

The cross-correlation of two functions \(f,g\) is defined by

\begin{equation}
  \rho_{fg}(x)=\int_\Gamma f(y)g(y-x)dy.
\end{equation}

We can reduce this quantity to a function of distance
\(r=\sqrt{x_1^2+x_2^2}\) using the average

\begin{equation}
  \bar\rho_{fg}(r)=\frac{1}{2\pi r}\int_0^{2\pi}\rho_{fg}((r\cos\theta,r\sin\theta))d\theta.
\end{equation}

The autocorrelation of \(f\) is then \(\rho_{ff}\).

\hypertarget{cross-covariance}{%
\subsection{Cross-covariance}\label{cross-covariance}}

Following the above definitions of spatial moments and
cross-correlation, we compute the cross-covariance of two spatial
functions \(f\) and \(g\) (in 2D space) via

\begin{equation}
  K_{fg}(x)=\sqrt{\mathrm{Var}(f)\mathrm{Var}(g)}\rho_{f,g}(x).
\end{equation}

Hence, inspired by the definition of \(\bar\rho_{fg}\), we can define
the cross covariance between spatial functions \(f\) and \(g\) at two
locations separated by distance \(r\) via

\begin{equation}
  \bar K_{fg}(r)=\frac{1}{2\pi r}\sqrt{\mathrm{Var}(f)\mathrm{Var}(g)}\int_0^{2\pi}K_{fg}((r\cos\theta,r\sin\theta))d\theta.
\end{equation}

\hypertarget{a-stable-equilibrium-of-pde}{%
\section{\texorpdfstring{A Stable Equilibrium of PDE
(\ref{deterministic})}{A Stable Equilibrium of PDE ()}}\label{a-stable-equilibrium-of-pde}}

To find an equilibrium of the deterministic PDE (\ref{deterministic}) we
set the time derivatives of \(\bar z_H\) and \(\bar z_P\) equal to zero.
This leads to following systems of ODE's

\begin{subequations}
  \begin{equation}
    0=G_HA_H(\theta_H-\bar z_H)-G_HB_H(\bar z_P-\bar z_H)+\frac{D_H}{2}\Delta\bar z_H,
  \end{equation}
  \begin{equation}
    0=G_PA_P(\theta_P-\bar z_P)+G_PB_P(\bar z_H-\bar z_P)+\frac{D_P}{2}\Delta\bar z_P.
  \end{equation}
\end{subequations}

Solving this system for the mean traits \(\bar z_H(x_1,x_2)\) and
\(\bar z_P(x_1,x_2)\) as spatial functions then returns equilibrium
solutions to PDE (\ref{deterministic}). However, we can start simple by
considering spatially homogeneous solutions. In these cases the spatial
derivatives will return zero (in particular,
\(\Delta\bar z_H=\Delta\bar z_P=0\)). Finding these solutions amounts to
solve the following system of algebraic equations

\begin{subequations}
  \begin{equation}
    0=G_HA_H(\theta_H-\bar z_H)-G_HB_H(\bar z_P-\bar z_H),
  \end{equation}
  \begin{equation}
    0=G_PA_P(\theta_P-\bar z_P)+G_PB_P(\bar z_H-\bar z_P).
  \end{equation}
\end{subequations}

This linear system is uniquely solved by

\begin{subequations}\label{non-spatial-eq}
  \begin{equation}
    \bar z_P(x_1,x_2)\equiv\frac{(A_H-B_H)A_P\theta_P+B_PA_H\theta_H}{(A_H-B_H)A_P+B_PA_H},
  \end{equation}
  \begin{equation}
    \bar z_H(x_1,x_2)\equiv\frac{(A_P+B_P)A_H\theta_H-B_HA_P\theta_P}{(A_P+B_P)A_H-B_HA_P},
  \end{equation}
\end{subequations}

where the symbol \(\equiv\) is used in place of \(=\) to emphasize these
functions are constant across space.

To understand whether this equilibrium is stable we perform stability
analysis on the non-spatial model. Notice that system
(\ref{non-spatial}) can be rewritten in matrix notation as
\(\vec{\bar z}=M\vec{\bar z}+\vec b\) where

\begin{subequations}
  \begin{equation}
    \vec{\bar z}=\left(\begin{matrix}
      \bar z_H \\ \bar z_P
    \end{matrix}\right), \ 
    \vec b =\left(\begin{matrix}
      G_HA_H\theta_H \\ G_PA_P\theta_P
    \end{matrix}\right),
  \end{equation}
  \begin{equation}
    M=\left(\begin{matrix}
      G_H(B_H-A_H) & -G_HB_H \\
      G_PB_P & -G_P(A_P+B_P)
    \end{matrix}\right).
  \end{equation}
\end{subequations}

It turns that if the real parts of the eigenvalues of \(M\) are negative
then equilibrium (\ref{non-spatial-eq}) is stable. This condition holds
in general when \(B_H<A_H+(A_P+B_P)G_P/G_H\) and \(B_H<A_H(1+B_P/A_P)\).
A sufficient condition with clear biological intuition is \(B_H<A_H\),
which just means the strength of biotic selection on the host is less
than the strength of abiotic stabilizing selection. In this case abiotic
stabilizing selection prevents the host from escaping via evolution.

\hypertarget{stationary-solutions-of-spde}{%
\section{\texorpdfstring{Stationary Solutions of SPDE
(\ref{spde})}{Stationary Solutions of SPDE ()}}\label{stationary-solutions-of-spde}}

To focus on stationary solutions of the stochastic system (\ref{spde})
we set the time derivatives to zero to obtain the following system

\begin{subequations}\label{stationary-spde}
  \begin{equation}
    G_HA_H(\theta_H-\bar Z_H)-G_HB_H(\bar Z_P-\bar Z_H)+\frac{D_H}{2}\Delta\bar Z_H=\sqrt\frac{G_H}{N_H}\dot W_H,
  \end{equation}
  \begin{equation}
    G_PA_P(\theta_P-\bar Z_P)+G_PB_P(\bar Z_H-\bar Z_P)+\frac{D_P}{2}\Delta\bar Z_P=\sqrt\frac{G_P}{N_P}\dot W_P.
  \end{equation}
\end{subequations}

If we further restrict our focus to the single species case we recover a
SPDE of the form

\begin{equation}\label{simple-form}
  b^2(a-u)+\Delta u=\sigma\dot W.
\end{equation}

In the case of two spatial dimensions, it is known that equation
(\ref{simple-form}) is satisfied by a Gaussian field with a Whittle
covariance function (Whittle 1963; Sigrist, Künsch, and Stahel 2014).
Denoting \(K_1\) the modified Bessel function of the second kind, order
1, the Whittle covariance function is given by
\(C(r)=\frac{\sigma^2r}{2b}K_1(br)\). Hence, we can postulate that
solutions of the stationary system (\ref{stationary-spde}) will have
Whittle cross-covariance matrices.

\hypertarget{the-autocovariances-and-cross-covariance-of-bar-z_h-and-bar-z_p}{%
\section{\texorpdfstring{The autocovariances and cross-covariance of
\(\bar Z_H\) and
\(\bar Z_P\)}{The autocovariances and cross-covariance of \textbackslash bar Z\_H and \textbackslash bar Z\_P}}\label{the-autocovariances-and-cross-covariance-of-bar-z_h-and-bar-z_p}}

Set \(\bar z_H(x)=\mathbb E[\bar Z_H(x)]\) and
\(\bar z_P(x)=\mathbb E[\bar Z_P(x)]\). Since the system
(\ref{stationary-spde}) is linear, we can expect \((\bar z_H,\bar z_P)\)
to solve the associated deterministic system. Then, it seems reasonable
to expect the cross-covariance of \(\bar Z_H\) and \(\bar Z_P\) across
space to satisfy

\begin{equation}
  K_{\bar Z_H\bar Z_P}(x)=K_{\bar z_H\bar z_P}(x)+K_A(x)+\mathcal B(x),
\end{equation} where \(K_A(x)\) is the cross-covariance of \(\bar Z_H\)
and \(\bar Z_P\) in the absence of biotic selection (ie., when
\(B_H=B_P=0\)) and \(\mathcal B(x)\) captures the potential for
deterministic processes to interact with the stochastic effects.

Note that in the case of the stable equilibrium considered above,
\(\bar z_H\) and \(\bar z_P\) are spatially homogeneous which implies
\(K_{\bar z_H\bar z_P}(x)\equiv0\).

In general, the signature of coevolution is likely to be found in
\(K_{\bar z_H\bar z_P}(x)\) and \(\mathcal B(x)\).

\newpage

\hypertarget{references}{%
\section*{References}\label{references}}
\addcontentsline{toc}{section}{References}

\hypertarget{refs}{}
\leavevmode\hypertarget{ref-Sigrist2014}{}%
Sigrist, Fabio, Hans R. Künsch, and Werner A. Stahel. 2014. ``Stochastic
Partial Differential Equation Based Modelling of Large Space-Time Data
Sets.'' \emph{Journal of the Royal Statistical Society: Series B
(Statistical Methodology)} 77 (1): 3--33.
\url{https://doi.org/10.1111/rssb.12061}.

\leavevmode\hypertarget{ref-whittle1963stochastic}{}%
Whittle, Peter. 1963. ``Stochastic-Processes in Several Dimensions.''
\emph{Bulletin of the International Statistical Institute} 40 (2):
974--94.

\bibliographystyle{unsrt}
\bibliography{references.bib}


\end{document}
